import psycopg2
import sys
import datetime


# Abre la coneccion y la request
#van los datos de la BBDD a utilizar, en caso de usar el de Postgres compartido, cambiar los datos 
connection = psycopg2.connect(user="postgres",
                              password="chirus2020",
                              host="localhost",
                              port="5433",
                              database="postgres")

cur = connection.cursor()
print("conectado")

cur.execute ('SELECT id,subrama FROM transitabilidad.rus order by id')
rows= cur.fetchall()

diccionario = {'residencial':['VIVIENDA UNICA','VIVIENDA','CASA','DEPARTAMENTOS'],'oficinas':['OFICINAS','PRODUCCION DE MUSICA, FILMES Y VIDEOCINTAS','SERVICOS EMPRESARIALES PROFESIONALES','SERVICIOS DE RADIO Y TELEVISION'], 'servicios': ['INSTALACIONES PARA EDIFICIOS Y OBRAS DE INGENIERIA CIVIL','SERVICIOS INMOBILIARIOS','SERVICIOS DE ASOCIACIONES','SUCURSAL BANCARIA','SERVICIOS DE BOLSAS DE COMERCIO','UNIFICADO GARAGE','UNIFICADO GARAGE PRIVADO','INSTALACION DE ASCENSORES, MONTACARGAS Y ESCALERAS MECANICAS','UNIFICADO EDIFICIO','TV. RADIO, ESPECTACULOS, CULTURALES','INSTALACIONES DE GAS, AGUA, SANITARIOS Y DE CLIMATIZACION','FABRICACIÓN DE PRODUCTOS ELABORADOS DE METAL NCP''ADMINISTRACION PUBLICA, DEFENSA Y SEGURIDAD SOCIAL OBLIGATORIA','SERVICIOS PARA EL ORDEN PUBLICO Y LA SEGURIDAD','ADMINISTRACION PUBLICA','SERVICIOS PUBLICOS','SERVICIOS DE LA ADMINISTRACION PUBLICA','SERVICIOS DE LA SEGURIDAD SOCIAL OBLIGATORIA', 'SERVICIOS SOCIALES','SERVICIOS DE SINDICATOS','ELIMINACION DE DESPERDICIOS Y AGUAS RESIDUALES, SANEAMIENTO Y SERVICIOS SIMILARES','GENERACION, TRANSPORTE Y DISTRIBUCION DE ENERGIA ELECTRICA','SERVICIOS DE ASOCIACIONES','SERVICIOS DE ASOCIACIONES NCP','SERVICIOS DE MERCADOS Y CAJA DE VALORES','SERVICIOS DE ORGANIZACIONES EMPRESARIALES Y DE EMPLEADORES','SERVICIOS DE ORGANIZACIONES RELIGIOSAS','SERVICIOS COMPLEMENTARIOS AL TRANSPORTE','SERVICIOS DE ASUNTOS EXTERIORES', 'SERVICIO DE TRANSPORTE URBANO DE CARGA','SERVICIO DE TRANSPORTE','RECICLAMIENTO DE DESPERDICIOS Y DESECHOS NO METALICOS'],'sitios_de_interes_entretenimiento': ['BIBLIOTECA','MUSEO','PRODUCCION DE ESPECTACULOS TEATRALES Y MUSICALES','EXHIBICON DE FILMES Y VIDEOCINTAS', 'SERVICIOS DE ESPARCIMIENTO RELACIONADOS CON JUEGOS DE AZAR Y APUESTAS','SERVICIO DE ENTRETENIMIENTO NCP','PLAZA', 'PLAZOLETA'],'gastronomia_hoteleria': ['GASTRONOMIA','HOTELERIA'],'comercial':['VENTA DE MOTOS, PARTES Y ACCESORIOS','VENTA AL POR MAYOR DE MADERA, MATERIALES PARA LA CONSTRUCCION. PLOMERIA E INSTALACIONES DE GAS','VENTA AL POR MAYOR DE MUEBLES E INSTALACIONES PARA LA INDUSTRIA, EL COMERCIO Y LOS SERVICIOS','VENTA POR MAYOR DE MAQUINAS, EQUIPOS Y MATERIALES CONEXOS','EDICION E IMPRESIÓN','VENTA AL POR MAYOR DE MAQUINAS, EQUIPOS Y MATERIALES CONEXOS NCP','VENTA AL POR MAYOR DE ALIMENTOS Y BEBIDAS','CONFECCION DE PRENDAS DE VESTIR','VENTA POR MAYOR DE METALES Y MINERALES METALIFEROS','VENTA POR MAYOR DE MERCANCIAS','VENTA POR MAYOR DE MAQUINAS,EQUIPOS Y MATERIALES CONEXOS','VENTA DE VEHICULOS AUTOMOTORES','VENTA DE PARTES Y ACCESORIOS PARA AUTOMOTORES','VENTA DE MOTOS,PARTES Y ACCESORIOS','VENTA DE LOCALES ESPECIALIZADOS','VENTA DE COMBUSTIBLES Y LUBRICANTE PARA AUTOMOTORES','VENTA AL POR MENOR EXEPTO LA ESPECIALIZADA' ,'VENTA AL POR MENOR ESPECIALIZADO NCP','VENTA AL POR MENOR DE PRODUCTOS ALIMENTICIOS ESPECIALIZADOS','VENTA AL POR MENOR DE ARTICULOS USADOS','VENTA AL POR MAYOR EN COMISION O CONSIGNACION DE MERCANCIAS NCP' ,'VENTA AL POR MAYOR DE MUEBLES E INSTALACIONES PARA LA INDUSTRIA,EL COMERCIO Y LOS SERVICIOS','VENTA AL POR MAYOR DE MERCANCIAS NCP','VENTA AL POR MAYOR DE MAQUINAS,EQUIPOS Y MATERIALES CONEXOS NCP','VENTA AL POR MAYOR DE MADERA,MATERIALES PARA LA CONSTRUCCION. PLOMERIA E INSTALACIONES DE GAS','VENTA AL POR MAYOR DE ARTICULOS DE USO DOMESTICO O PERSONAL NCP','LOTERIA','CASA DE CAMBIO','DISTRIBUCION DE FILMES Y VIDEOCINTAS','PELUQUERIA Y TRATAMIENTOS DE BELLEZA','SERVICIOS INMOBILIARIOS','SERVICIOS INMOBILIARIOS','LAVADO Y LIMPIEZA','REPARACION DE EFECTOS PERSONALES Y ENSERES DOMESTICOS','REPARACION DE MOTOS','EDICION E IMPRESIÃ“N','SERVICIO DE CORREO Y TELECOMUNICACIONES','SERVICIO DE SALONES DE JUEGO','POMPAS FUNEBRES','PRODUCTOS DE MADERA','PREPARACION DE TERRENOS PARA OBRAS','SERVICIOS FINANCIEROS NCP','SERVICIOS INFORMATICOS Y ACTIVIDADES CONEXAS','SERVICIOS JURIDICOS','MANTENIMIENTO Y REPARACION','ELABORACION DE PRODUCTOS LACTEOS','ELABORACION DE PRODUCTOS ALIMENTICIOS','ALQUILER DE EQUIPO DE TRANSPORTE','ALQUILER DE MAQUINARIA Y EQUIPO NCP','ALQUILER DE ENSERES PERSONALES Y EQUIPOS','SERVICIOS DE SEGUROS','SERVICIOS NCP','SERVICIOS EMPRESARIALES NCP','GALERIA','SERVICIO DE TELECOMUNICACIONES','SERVICIO DE TRANSPORTE AEREO DE CARGA','SERVICIO DE TRANSPORTE AEREO DE PASAJEROS','SERVICIOS DE MUDANZA','SERVICIOS TURISTICOS','SERVICIOS VETERINARIOS','SERVICOS EMPRESARIALES NO PROFESIONALES','TV. RADIO,ESPECTACULOS,CULTURALES','SERVICIOS DE SEGUROS DE SALUD','UNIFICADO LOCAL','DEPORTES','UNIFICADO ESTACION DE SERVICIOS','INSTALACIONES DE GAS,AGUA,SANITARIOS Y DE CLIMATIZACION','SERVICIO DE TRANSPORTE AUTOMOTOR DE PASAJEROS','SERVICIOS DE ENTIDADES FINANCIERAS NO BANCARIAS','PRODUCCION DE FILMES Y VIDEOCINTAS','PRODUCCION Y PROCESAMIENTO DE CARNE,FRUTAS,LEGUMBRES,HORTALIZAS,ACEITES Y GRASAS','INSTALACION DE ASCENSORES,MONTACARGAS Y ESCALERAS MECANICAS','SERVICIOS DE SEGUROS PATRIMONIALES' ,'SERVICIOS COMPLEMENTARIOS AL TRANSPORTE TERRESTRE'],'salud':['SALUD','SERVICIOS DE ATENCION MEDICA'],'educacion': ['ENSEÑANZA INICIAL Y PRIMARIA','ENSEÑANZA INICIAL, PRIMARIA Y SECUNDARIA','ENSEÑANZA PARA ADULTOS Y SERVICIOS DE ENSEÑANZA NCP','ENSEÑANZA SECUNDARIA DE FORMACION PROFESIONAL Y TECNICA','ENSEÑANZA SUPERIOR Y FORMACION DE POSGRADO'],'industria': ['PRODUCCION Y PROCESAMIENTO DE CARNE, FRUTAS, LEGUMBRES, HORTALIZAS, ACEITES Y GRASAS','FABRICACION DE PRODUCTOS TEXTILES', 'FABRICACION DE INSTRUMENTOS MEDICOS, OPTICOS Y DE PRECISION; FABRICACION DE RELOJES', 'FABRICACION DE EQUIPOS DE COMUNICACION', 'ELABORACION DE PRODUCTOS ALIMENTICIOS NCP', 'FABRICACIN DE TEJIDOS DE PUNTO','ELABORACIN DE BEBIDAS NO ALCOHOLICAS; PRODUCCION DE AGUAS MINERALES','ELABORACION DE BEBIDAS','ELABORACION DE PRODUCTOS DE MOLINERIA, ALMIDONES Y PRODUCTOS DERIVADOS DEL ALMIDON, ELABORACION DE *','CONFECCION DE ROPA INTERIOR, PRENDAS PARA DORMIR Y PARA LA PLAYA','CURTIDO Y TERMINACION DE CUEROS; FABRICACION DE ARTICULOS DE MARROQUINERIA TALABARTERIA','FABRICACIN DE PINTURAS, BARNICES Y PRODUCTOS DE REVESTIMIENTO, TINTAS DE IMPRENTA Y MASILLAS','FABRICACION DE PRODUCTOS ELABORADOS DE METAL NCP','FABRICACION DE APARATOS DE USO DOMESTICO NCP','FABRICACION DE ARTICULOS DE MARROQUINERIA, TALABARTERIA Y CALZADO Y DE SUS PARTES' ,'FABRICACION DE AUTOPARTES, PIEZAS Y ACCESORIOS PARA VEHICULOS AUTOMOTORES Y SUS MOTORES','FABRICACION DE CALZADO Y DE SUS PARTES','FABRICACION DE COSMETICOS, PERFUMES Y PRODUCTOS DE HIGIENE Y TOCADOR','FABRICACION DE EQUIPO ELECTRICO','FABRICACION DE HILADOS Y TEJIDOS' ,'FABRICACION DE JABONES Y DETERGENTES, PREPARADOS PARA LIMPIAR Y PULIR, PERFUMES Y PREPARADOS DE TOC*','FABRICACION DE LAMPARAS ELECTRICAS Y EQUIPO DE ILUMINACION','FABRICACION DE MALETAS, BOLSOS, Y SIMILARES, ARTICULOS DE TALABARTERIA Y ARTICULOS DE CUERO NCP','FABRICACION DE MAQUINARIA DE OFICINA, CONTABILIDAD E INFORMATICA','FABRICACION DE MAQUINARIA DE USO GENERAL','FABRICACION DE MAQUINARIA DE USO GENERAL NCP','FABRICACION DE MAQUINARIA DE USO GENERAL Y ESPECIAL NCP','FABRICACION DE MEDICAMENTOS','FABRICACION DE MOTORES, GENERADORES Y TRANSFORMADORES ELECTRICOS','FABRICACION DE MUEBLES Y COLCHONES','FABRICACION DE PAPEL Y PRODUCTOS DE PAPEL','FABRICACION DE PARTES Y PIEZAS DE CARPINTERIA PARA CONSTRUCCIONES','FABRICACION DE PRODUCTOS DE CAUCHO','FABRICACION DE PRODUCTOS DE LA REFINACION DEL PETROLEO','FABRICACION DE PRODUCTOS METALICOS NCP','FABRICACION DE PRODUCTOS MINERALES NO METALICOS NCP','FABRICACION DE PRODUCTOS PLASTICOS','FABRICACION DE PRODUCTOS QUIMICOS','FABRICACION DE PRODUCTOS TEXTILES NCP','FABRICACION DE VIDRIO Y PRODUCTOS DE VIDRIO','SERVICIOS AGRICOLAS','GALPON','UNIFICADO GALPON','INDUSTRIAS MANUFACTURERAS NCP','EDIFICIO PRODUCTIVO','SERVICIOS DE ALMACENAMIENTO Y DEPOSITO'],'comercial_neg' : ['CLAUSURADO','ABANDONADO','CERRADO','LOCAL CERRADO'],'en_obra' : ['EN OBRA','LOTE','UNIFICADO LOTE'] }


def buscar(values, searchFor):
    for k in values:
        for v in values[k]:
            if searchFor in v:
                return k
    return None

cur.execute("create table if not exists transitabilidad.comercios_rus (id integer, subrama character varying, categoria character varying)")
print ('Creaste la tabla! Buen trabajo')
for row in rows:
    id = str(row[0])
    subrama = str(row[1])
    categoria = buscar (diccionario,subrama)
    if categoria == None:
        categoria = 'S/D'


    cur.execute("insert into transitabilidad.comercios_rus values ('"+id+"','"+subrama+"','"+categoria+"')")
    connection.commit()
print ('Terminaste de categorizar!')
    